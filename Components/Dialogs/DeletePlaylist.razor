@using Ongaku.Models
@inject IDialogService DialogService
@inject Ongaku.Services.PlaylistService PlaylistService

<MudDialog>
	<TitleContent>Delete playlist</TitleContent>

	<DialogContent>
		<MudStack Style="width: 100%;" Class="d-flex flex-column gap-4 align-center">
			<MudText Style="text-align: center;">Are you shure you want delete playlist @playlist.Name?</MudText>
		</MudStack>
	</DialogContent>

	<DialogActions>
		<MudToolBar Gutters="false" Class="relative d-flex justify-end gap-4">
			<MudButton Color="Color.Secondary" Disabled="@_proccessing"
					   Variant="Variant.Filled" @onclick="Delete">
				@if (_proccessing)
				{
					<MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate />
					<MudText Class="ms-2">Proccessing</MudText>
				}
				else
				{
					<MudText>Delete</MudText>
				}
			</MudButton>
			<MudButton Color="Color.Error" Variant="Variant.Filled" @onclick="Cancel">
				Cancel
			</MudButton>
		</MudToolBar>
	</DialogActions>
</MudDialog>

@code {
	[CascadingParameter]
	private IMudDialogInstance? MudDialog { get; set; }

	[Parameter]
	public required Playlist playlist { get; set; }

	private bool _proccessing = false;

	private void Cancel()
	{
		MudDialog!.Close(DialogResult.Cancel());
	}

	private async Task Delete()
	{
		await PlaylistService.DeletePlaylist(playlist);

		MudDialog!.Close(DialogResult.Ok(true));
	}
}
